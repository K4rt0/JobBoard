name: Notify Telegram on Git Actions

on:
  push:
    branches:
      - '**'   # Láº¯ng nghe push trÃªn táº¥t cáº£ branch
  pull_request:
    types:
      - closed  # Láº¯ng nghe khi PR Ä‘Æ°á»£c merged hoáº·c closed

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send notification to Telegram
        run: |
          if [ "${{ github.event_name }}" == "push" ]; then
            EVENT_TYPE="ðŸ“Œ New Push"
            BRANCH_NAME=${{ github.ref }}
          elif [ "${{ github.event_name }}" == "pull_request" ] && [ "${{ github.event.pull_request.merged }}" == "true" ]; then
            EVENT_TYPE="ðŸ”€ Pull Request Merged"
            BRANCH_NAME=${{ github.event.pull_request.base.ref }}
          else
            exit 0
          fi

          MESSAGE="ðŸš€ *GitHub Repository*: ${{ github.repository }}\n"
          MESSAGE+="ðŸ‘¤ *User*: ${{ github.actor }}\n"
          MESSAGE+="ðŸ”€ *Branch*: ${BRANCH_NAME}\n"
          MESSAGE+="ðŸ”— [View Changes](https://github.com/${{ github.repository }}/commit/${{ github.sha }})"

          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "parse_mode=Markdown" \
            -d "text=$MESSAGE"
